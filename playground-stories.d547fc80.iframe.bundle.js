"use strict";(self.webpackChunkremark_docx=self.webpackChunkremark_docx||[]).push([[795],{"./stories/playground.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MarkdownToDocx:()=>MarkdownToDocx,__namedExportsOrder:()=>__namedExportsOrder,default:()=>playground_stories});var react=__webpack_require__("./node_modules/react/index.js"),lib=__webpack_require__("./node_modules/unified/lib/index.js"),remark_parse=__webpack_require__("./node_modules/remark-parse/index.js"),remark_gfm=__webpack_require__("./node_modules/remark-gfm/index.js"),remark_frontmatter=__webpack_require__("./node_modules/remark-frontmatter/index.js"),remark_math=__webpack_require__("./node_modules/remark-math/index.js"),unist_util_visit_lib=__webpack_require__("./node_modules/unist-util-visit/lib/index.js"),build=__webpack_require__("./node_modules/docx/build/index.js"),unified_latex_util_parse=__webpack_require__("./node_modules/@unified-latex/unified-latex-util-parse/index.js"),unreachable=_=>{throw new Error("unreachable")};function invariant(cond,message){if(!cond)throw new Error(message)}var hasCurlyBrackets=arg=>!!arg&&"{"===arg.openMark&&"}"===arg.closeMark,mapString=s=>new build.MathRun(s),mapGroup=nodes=>{var group=[];for(var c of nodes)group.push(...mapNode(c,group)||[]);return group},mapNode=(n,runs)=>{switch(n.type){case"root":case"whitespace":case"parbreak":case"comment":case"environment":case"mathenv":case"verbatim":case"inlinemath":case"displaymath":case"verb":break;case"string":return[mapString(n.content)];case"macro":var run=((n,runs)=>{switch(n.content){case"#":return mapString("#");case"$":return mapString("$");case"%":return mapString("%");case"&":return mapString("&");case"textasciitilde":return mapString("~");case"textasciicircum":return mapString("^");case"textbackslash":return mapString("∖");case"{":return mapString("{");case"}":return mapString("}");case"textbar":return mapString("|");case"textless":return mapString("<");case"textgreater":return mapString(">");case"neq":return mapString("≠");case"sim":return mapString("∼");case"simeq":return mapString("≃");case"approx":return mapString("≈");case"fallingdotseq":return mapString("≒");case"risingdotseq":return mapString("≓");case"equiv":return mapString("≡");case"geq":return mapString("≥");case"geqq":return mapString("≧");case"leq":return mapString("≤");case"leqq":return mapString("≦");case"gg":return mapString("≫");case"ll":return mapString("≪");case"times":return mapString("×");case"div":return mapString("÷");case"pm":return mapString("±");case"mp":return mapString("∓");case"oplus":return mapString("⊕");case"ominus":return mapString("⊖");case"otimes":return mapString("⊗");case"oslash":return mapString("⊘");case"circ":return mapString("∘");case"cdot":return mapString("⋅");case"bullet":return mapString("∙");case"ltimes":return mapString("⋉");case"rtimes":return mapString("⋊");case"in":return mapString("∈");case"ni":return mapString("∋");case"notin":return mapString("∉");case"subset":return mapString("⊂");case"supset":return mapString("⊃");case"subseteq":return mapString("⊆");case"supseteq":return mapString("⊇");case"nsubseteq":return mapString("⊈");case"nsupseteq":return mapString("⊉");case"subsetneq":return mapString("⊊");case"supsetneq":return mapString("⊋");case"cap":return mapString("∩");case"cup":return mapString("∪");case"emptyset":return mapString("∅");case"infty":return mapString("∞");case"partial":return mapString("∂");case"aleph":return mapString("ℵ");case"hbar":return mapString("ℏ");case"wp":return mapString("℘");case"Re":return mapString("ℜ");case"Im":return mapString("ℑ");case"alpha":return mapString("α");case"beta":return mapString("β");case"gamma":return mapString("γ");case"delta":return mapString("δ");case"epsilon":return mapString("ϵ");case"zeta":return mapString("ζ");case"eta":case"eta":return mapString("η");case"theta":return mapString("θ");case"iota":return mapString("ι");case"kappa":return mapString("κ");case"lambda":return mapString("λ");case"mu":return mapString("μ");case"nu":return mapString("ν");case"xi":return mapString("ξ");case"pi":return mapString("π");case"rho":return mapString("ρ");case"sigma":return mapString("σ");case"tau":return mapString("τ");case"upsilon":return mapString("υ");case"phi":return mapString("ϕ");case"chi":return mapString("χ");case"psi":return mapString("ψ");case"omega":return mapString("ω");case"varepsilon":return mapString("ε");case"vartheta":return mapString("ϑ");case"varrho":return mapString("ϱ");case"varsigma":return mapString("ς");case"varphi":return mapString("φ");case"Gamma":return mapString("Γ");case"Delta":return mapString("Δ");case"Theta":return mapString("Θ");case"Lambda":return mapString("Λ");case"Xi":return mapString("Ξ");case"Pi":return mapString("Π");case"Sigma":return mapString("Σ");case"Upsilon":return mapString("Υ");case"Phi":return mapString("Φ");case"Psi":return mapString("Ψ");case"Omega":return mapString("Ω");case"newline":case"\\":return!1;case"^":var _n$args$0$content,_n$args,_n$args$,prev=runs.pop();if(!prev)break;return new build.MathSuperScript({children:[prev],superScript:mapGroup(null!==(_n$args$0$content=null===(_n$args=n.args)||void 0===_n$args||null===(_n$args$=_n$args[0])||void 0===_n$args$?void 0:_n$args$.content)&&void 0!==_n$args$0$content?_n$args$0$content:[])});case"_":var _n$args$0$content2,_n$args2,_n$args2$,_prev=runs.pop();if(!_prev)break;return new build.MathSubScript({children:[_prev],subScript:mapGroup(null!==(_n$args$0$content2=null===(_n$args2=n.args)||void 0===_n$args2||null===(_n$args2$=_n$args2[0])||void 0===_n$args2$?void 0:_n$args2$.content)&&void 0!==_n$args$0$content2?_n$args$0$content2:[])});case"hat":case"widehat":default:break;case"sum":return new build.MathSum({children:[]});case"int":return mapString("∫");case"frac":case"tfrac":case"dfrac":var _n$args3,args=null!==(_n$args3=n.args)&&void 0!==_n$args3?_n$args3:[];if(2===args.length&&hasCurlyBrackets(args[0])&&hasCurlyBrackets(args[1]))return new build.MathFraction({numerator:mapGroup(args[0].content),denominator:mapGroup(args[1].content)});break;case"sqrt":var _n$args4,_args=null!==(_n$args4=n.args)&&void 0!==_n$args4?_n$args4:[];if(1===_args.length&&hasCurlyBrackets(_args[0]))return new build.MathRadical({children:mapGroup(_args[0].content)});if(2===_args.length&&(arg=_args[0])&&"["===arg.openMark&&"]"===arg.closeMark&&hasCurlyBrackets(_args[1]))return new build.MathRadical({children:mapGroup(_args[1].content),degree:mapGroup(_args[0].content)})}var arg;return mapString(n.content)})(n,runs);return!!run&&[run];case"group":return mapGroup(n.content);default:unreachable()}return[]},parseLatex=value=>{var parsed=(0,unified_latex_util_parse.xo)(value),paragraphs=[[]],runs=paragraphs[0];for(var n of parsed){var res=mapNode(n,runs);res?runs.push(...res):paragraphs.push(runs=[])}return paragraphs};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DEFAULT_NUMBERINGS=[{level:0,format:build.LevelFormat.DECIMAL,text:"%1.",alignment:build.AlignmentType.START},{level:1,format:build.LevelFormat.DECIMAL,text:"%2.",alignment:build.AlignmentType.START,style:{paragraph:{indent:{start:(0,build.convertInchesToTwip)(.5)}}}},{level:2,format:build.LevelFormat.DECIMAL,text:"%3.",alignment:build.AlignmentType.START,style:{paragraph:{indent:{start:(0,build.convertInchesToTwip)(1)}}}},{level:3,format:build.LevelFormat.DECIMAL,text:"%4.",alignment:build.AlignmentType.START,style:{paragraph:{indent:{start:(0,build.convertInchesToTwip)(1.5)}}}},{level:4,format:build.LevelFormat.DECIMAL,text:"%5.",alignment:build.AlignmentType.START,style:{paragraph:{indent:{start:(0,build.convertInchesToTwip)(2)}}}},{level:5,format:build.LevelFormat.DECIMAL,text:"%6.",alignment:build.AlignmentType.START,style:{paragraph:{indent:{start:(0,build.convertInchesToTwip)(2.5)}}}}],convertNodes=(nodes,ctx)=>{var results=[],footnotes={};for(var node of nodes)switch(node.type){case"paragraph":results.push(buildParagraph(node,ctx));break;case"heading":results.push(buildHeading(node,ctx));break;case"thematicBreak":results.push(buildThematicBreak(node));break;case"blockquote":results.push(...buildBlockquote(node,ctx));break;case"list":results.push(...buildList(node,ctx));break;case"listItem":invariant(!1,"unreachable");case"table":results.push(buildTable(node,ctx));break;case"tableRow":invariant(!1,"unreachable");case"tableCell":invariant(!1,"unreachable");case"html":results.push(buildHtml(node));break;case"code":results.push(buildCode(node));break;case"yaml":case"toml":case"definition":break;case"footnoteDefinition":footnotes[node.identifier]=buildFootnoteDefinition(node,ctx);break;case"text":results.push(buildText(node.value,ctx.deco));break;case"emphasis":case"strong":case"delete":var{type,children}=node,{nodes:_nodes}=convertNodes(children,_objectSpread(_objectSpread({},ctx),{},{deco:_objectSpread(_objectSpread({},ctx.deco),{},{[type]:!0})}));results.push(..._nodes);break;case"inlineCode":results.push(buildText(node.value,ctx.deco));break;case"break":results.push(buildBreak(node));break;case"link":results.push(buildLink(node,ctx));break;case"image":results.push(buildImage(node,ctx.images));break;case"linkReference":case"imageReference":break;case"footnote":results.push(buildFootnote(node,ctx));break;case"footnoteReference":results.push(buildFootnoteReference(node));break;case"math":results.push(...buildMath(node));break;case"inlineMath":results.push(buildInlineMath(node));break;default:unreachable()}return{nodes:results,footnotes}},buildParagraph=(_ref2,ctx)=>{var{children}=_ref2,list=ctx.list,{nodes}=convertNodes(children,ctx);return new build.Paragraph(_objectSpread({children:nodes,indent:ctx.indent>0?{start:(0,build.convertInchesToTwip)(.5*ctx.indent)}:void 0},list&&(list.ordered?{numbering:{reference:"ordered",level:list.level}}:{bullet:{level:list.level}})))},buildHeading=(_ref3,ctx)=>{var heading,{children,depth}=_ref3;switch(depth){case 1:heading=build.HeadingLevel.TITLE;break;case 2:heading=build.HeadingLevel.HEADING_1;break;case 3:heading=build.HeadingLevel.HEADING_2;break;case 4:heading=build.HeadingLevel.HEADING_3;break;case 5:heading=build.HeadingLevel.HEADING_4;break;case 6:heading=build.HeadingLevel.HEADING_5}var{nodes}=convertNodes(children,ctx);return new build.Paragraph({heading,children:nodes})},buildThematicBreak=_=>new build.Paragraph({thematicBreak:!0}),buildBlockquote=(_ref4,ctx)=>{var{children}=_ref4,{nodes}=convertNodes(children,_objectSpread(_objectSpread({},ctx),{},{indent:ctx.indent+1}));return nodes},buildList=(_ref5,ctx)=>{var{children,ordered,start:_start,spread:_spread}=_ref5,list={level:ctx.list?ctx.list.level+1:0,ordered:!!ordered};return children.reduce(((acc,item)=>(acc.push(...buildListItem(item,_objectSpread(_objectSpread({},ctx),{},{list}))),acc)),[])},buildListItem=(_ref6,ctx)=>{var{children,checked:_checked,spread:_spread}=_ref6,{nodes}=convertNodes(children,ctx);return nodes},buildTable=(_ref7,ctx)=>{var{children,align}=_ref7,cellAligns=null==align?void 0:align.map((a=>{switch(a){case"left":default:return build.AlignmentType.LEFT;case"right":return build.AlignmentType.RIGHT;case"center":return build.AlignmentType.CENTER}}));return new build.Table({rows:children.map((r=>buildTableRow(r,ctx,cellAligns)))})},buildTableRow=(_ref8,ctx,cellAligns)=>{var{children}=_ref8;return new build.TableRow({children:children.map(((c,i)=>buildTableCell(c,ctx,null==cellAligns?void 0:cellAligns[i])))})},buildTableCell=(_ref9,ctx,align)=>{var{children}=_ref9,{nodes}=convertNodes(children,ctx);return new build.TableCell({children:[new build.Paragraph({alignment:align,children:nodes})]})},buildHtml=_ref10=>{var{value}=_ref10;return new build.Paragraph({children:[buildText(value,{})]})},buildCode=_ref11=>{var{value,lang:_lang,meta:_meta}=_ref11;return new build.Paragraph({children:[buildText(value,{})]})},buildMath=_ref12=>{var{value}=_ref12;return parseLatex(value).map((runs=>new build.Paragraph({children:[new build.Math({children:runs})]})))},buildInlineMath=_ref13=>{var{value}=_ref13;return new build.Math({children:parseLatex(value).flatMap((runs=>runs))})},buildText=(text,deco)=>new build.TextRun({text,bold:deco.strong,italics:deco.emphasis,strike:deco.delete}),buildBreak=_=>new build.TextRun({text:"",break:1}),buildLink=(_ref14,ctx)=>{var{children,url,title:_title}=_ref14,{nodes}=convertNodes(children,ctx);return new build.ExternalHyperlink({link:url,children:nodes})},buildImage=(_ref15,images)=>{var{url,title:_title,alt:_alt}=_ref15,img=images[url];invariant(img,"Fetch image was failed: ".concat(url));var{image,width,height}=img;return new build.ImageRun({data:image,transformation:{width,height}})},buildFootnote=(_ref16,ctx)=>{var{children}=_ref16,{nodes}=convertNodes(children,ctx);return new build.Paragraph({children:nodes})},buildFootnoteDefinition=(_ref17,ctx)=>{var{children}=_ref17;return{children:children.map((node=>{var{nodes}=convertNodes([node],ctx);return nodes[0]}))}},buildFootnoteReference=_ref18=>{var{identifier}=_ref18;return new build.FootnoteReferenceRun(parseInt(identifier))};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}const src_plugin=function plugin(){var opts=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},images={};return this.Compiler=node=>((node,_ref,images)=>{var{output="buffer",title,subject,creator,keywords,description,lastModifiedBy,revision,styles,background}=_ref,{nodes,footnotes}=convertNodes(node.children,{deco:{},images,indent:0}),doc=new build.Document({title,subject,creator,keywords,description,lastModifiedBy,revision,styles,background,footnotes,sections:[{children:nodes}],numbering:{config:[{reference:"ordered",levels:DEFAULT_NUMBERINGS}]}});switch(output){case"buffer":return build.Packer.toBuffer(doc);case"blob":return build.Packer.toBlob(doc)}})(node,opts,images),function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}((function*(node){var imageList=[];if((0,unist_util_visit_lib.Vn)(node,"image",(node=>{imageList.push(node)})),0===imageList.length)return node;var imageResolver=opts.imageResolver;invariant(imageResolver,"options.imageResolver is not defined.");var imageDatas=yield Promise.all(imageList.map((_ref2=>{var{url}=_ref2;return imageResolver(url)})));return images=imageList.reduce(((acc,img,i)=>(acc[img.url]=imageDatas[i],acc)),{}),node}));return function(_x){return _ref.apply(this,arguments)}}()};var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),style={flex:1,overflowY:"scroll"},textAreaStyle={width:"100%",height:"100%"};const text_editor=(0,react.forwardRef)(((_ref,ref)=>{var{initialValue,onChange:_onChange}=_ref;return(0,jsx_runtime.jsx)("div",{style,children:(0,jsx_runtime.jsx)("textarea",{ref,style:textAreaStyle,defaultValue:initialValue,onChange:e=>_onChange(e.target.value)})})}));try{texteditor.displayName="texteditor",texteditor.__docgenInfo={description:"",displayName:"texteditor",props:{initialValue:{defaultValue:null,description:"",name:"initialValue",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(v: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/components/text-editor.tsx#texteditor"]={docgenInfo:texteditor.__docgenInfo,name:"texteditor",path:"stories/components/text-editor.tsx#texteditor"})}catch(__react_docgen_typescript_loader_error){}const article_namespaceObject='---\ntitle: "This is frontmatter"\ndate: 2020-04-30 12:34\ncategories: [JavaScript, React]\n---\n\n# heading 1\n\n## heading 2\n\n### heading 3\n\n#### heading 4\n\n##### heading 5\n\n###### heading 6\n\naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n\naaaaaaaa**bold**_emphasis_~~delete~~`inline code`\n\n- list\n\n  - list\n    - list\n  - list\n  - list\n\n- [ ] not checked\n- [x] checked\n\n1. ordered list\n1. ordered list\n1. ordered list\n   1. aaa\n   1. aaa\n      1. eeeee\n      1. eeeee\n   1. aaa\n1. ordered list\n\nThis is [link to GitHub.com](https://github.com/).\n\nThis is ![image](https://github.githubassets.com/images/modules/logos_page/Octocat.png).\n\n> quote\n> quote\n> quote\n> quote\n\n> quote\n>\n> > quoted quote\n\n| Left align | Right align | Center align |\n| :--------- | ----------: | :----------: |\n| This       |        This |     This     |\n| column     |      column |    column    |\n| will       |        will |     will     |\n| be         |          be |      be      |\n| left       |       right |    center    |\n| aligned    |     aligned |   aligned    |\n\n$$\nL = \\frac{1}{2} \\rho v^2 S C_L\n$$\n\n<div style="color:red;">\nThis is <u>HTML</u>\n</div>\n\n---\n\n---\n\n```javascript\nfunction $initHighlight(block, cls) {\n  try {\n    if (cls.search(/\\bno\\-highlight\\b/) != -1)\n      return process(block, true, 0x0F) +\n             ` class="${cls}"`;\n  } catch (e) {\n    /* handle exception */\n  }\n  for (var i = 0 / 2; i < classes.length; i++) {\n    if (checkCondition(classes[i]) === undefined)\n      console.log(\'undefined\');\n  }\n\n  return (\n    <div>\n      <web-component>{block}</web-component>\n    </div>\n  )\n}\n\nexport  $initHighlight;\n```\n';var _MarkdownToDocx$param,_MarkdownToDocx$param2,_MarkdownToDocx$param3,FileSaver_min=__webpack_require__("./node_modules/file-saver/dist/FileSaver.min.js"),docx_preview_min=__webpack_require__("./node_modules/docx-preview/dist/docx-preview.min.js");function playground_stories_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function playground_stories_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?playground_stories_ownKeys(Object(source),!0).forEach((function(key){playground_stories_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):playground_stories_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function playground_stories_defineProperty(obj,key,value){return(key=function playground_stories_toPropertyKey(arg){var key=function playground_stories_toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function playground_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function playground_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){playground_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){playground_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var fetchImage=function(){var _ref=playground_stories_asyncToGenerator((function*(url){var image=new Image,res=yield fetch(url),buf=yield res.arrayBuffer();return new Promise(((resolve,reject)=>{image.onload=()=>{resolve({image:buf,width:image.naturalWidth,height:image.naturalHeight})},image.onerror=reject,image.src=URL.createObjectURL(new Blob([buf],{type:"image/png"}))}))}));return function fetchImage(_x){return _ref.apply(this,arguments)}}(),toDocxProcessor=(0,lib.l)().use(remark_parse.Z).use(remark_gfm.Z).use(remark_frontmatter.Z).use(remark_math.Z).use(src_plugin,{output:"blob",imageResolver:fetchImage}),toDocx=function(){var _ref2=playground_stories_asyncToGenerator((function*(s){return(yield toDocxProcessor.process(s)).result}));return function toDocx(_x2){return _ref2.apply(this,arguments)}}();const playground_stories={title:"Playground"};var Wrapper=_ref3=>{var{children}=_ref3;return(0,jsx_runtime.jsx)("div",{style:(0,react.useMemo)((()=>({width:"100vw",height:"100vh",display:"flex",flexDirection:"column",fontSize:"10.5pt"})),[]),children})};Wrapper.displayName="Wrapper";var previewStyle={flex:1,overflow:"auto"},MarkdownToDocx=()=>{var ref=(0,react.useRef)(null),onChange=function(){var _ref4=playground_stories_asyncToGenerator((function*(v){var blob=yield toDocx(v);(0,docx_preview_min.renderAsync)(blob,document.getElementById("preview"),void 0,{useMathMLPolyfill:!0})}));return function onChange(_x3){return _ref4.apply(this,arguments)}}();return(0,react.useEffect)((()=>{onChange(article_namespaceObject)}),[]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("button",{onClick:playground_stories_asyncToGenerator((function*(){if(ref.current){var blob=yield toDocx(ref.current.value);(0,FileSaver_min.saveAs)(blob,"example.docx")}})),children:"download docx"})," ",(0,jsx_runtime.jsx)("span",{children:"Live preview may be different from actual docx"})]}),(0,jsx_runtime.jsxs)(Wrapper,{children:[(0,jsx_runtime.jsx)(text_editor,{ref,initialValue:article_namespaceObject,onChange}),(0,jsx_runtime.jsx)("div",{style:previewStyle,children:(0,jsx_runtime.jsx)("div",{id:"preview"})})]})]})};MarkdownToDocx.parameters=playground_stories_objectSpread(playground_stories_objectSpread({},MarkdownToDocx.parameters),{},{docs:playground_stories_objectSpread(playground_stories_objectSpread({},null===(_MarkdownToDocx$param=MarkdownToDocx.parameters)||void 0===_MarkdownToDocx$param?void 0:_MarkdownToDocx$param.docs),{},{source:playground_stories_objectSpread({originalSource:'() => {\n  const ref = useRef<HTMLTextAreaElement>(null);\n  const onChange = async (v: string) => {\n    const blob = await toDocx(v);\n    renderAsync(blob, document.getElementById("preview")!, undefined, {\n      useMathMLPolyfill: true\n    });\n  };\n  useEffect(() => {\n    onChange(text);\n  }, []);\n  return <>\n      <div>\n        <button onClick={async () => {\n        if (!ref.current) return;\n        const blob = await toDocx(ref.current.value);\n        saveAs(blob, "example.docx");\n      }}>\n          {"download docx"}\n        </button>{" "}\n        <span>Live preview may be different from actual docx</span>\n      </div>\n      <Wrapper>\n        <TextEditor ref={ref} initialValue={text} onChange={onChange} />\n        <div style={previewStyle}>\n          <div id="preview" />\n        </div>\n      </Wrapper>\n    </>;\n}'},null===(_MarkdownToDocx$param2=MarkdownToDocx.parameters)||void 0===_MarkdownToDocx$param2||null===(_MarkdownToDocx$param3=_MarkdownToDocx$param2.docs)||void 0===_MarkdownToDocx$param3?void 0:_MarkdownToDocx$param3.source)})});var __namedExportsOrder=["MarkdownToDocx"]}}]);